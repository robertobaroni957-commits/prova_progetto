<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>ZRL Manager Â· {% block title %}{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body class="d-flex">
{% include 'partials/admin_sidebar.html' %}

  {# ðŸ”’ Sidebar visibile solo se utente autenticato con ruolo definito #}
  {% set role = session.get('user_role') %}
  {% if session.get('user_id') and role %}
    {% include 'partials/' ~ role ~ '_sidebar.html' ignore missing %}
  {% endif %}

  <div class="main-content flex-grow-1 p-4">
    <header class="d-flex justify-content-between align-items-center mb-4">
      <h1 class="h4">{{ page_title or "ZRL Manager" }}</h1>
      <div>
        {% if session.get('user_email') %}
          <span class="me-3">ðŸ‘‹ {{ session.get('user_email') }}</span>
        {% endif %}
        {% if role %}
          <span class="badge bg-primary">{{ role|capitalize }}</span>
        {% endif %}
      </div>
    </header>

    {# ðŸ”” Messaggi flash #}
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} d-flex align-items-center" role="alert">
            <i class="bi bi-{{ 'check-circle' if category == 'success' else 'exclamation-triangle' if category == 'warning' else 'x-circle' if category == 'danger' else 'info-circle' }} me-2"></i>
            {{ message|safe }}
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
{% if session.get('user_id') and role %}

<!-- === PULSANTE HAMBURGER MOBILE === -->
<button class="btn btn-primary d-lg-none m-3" 
        type="button" 
        data-bs-toggle="offcanvas" 
        data-bs-target="#mobileSidebar" 
        aria-controls="mobileSidebar">
  <i class="bi bi-list fs-4"></i>
</button>

<!-- === SIDEBAR DESKTOP === -->
<aside class="sidebar d-none d-lg-block p-3 shadow-sm" style="width: 240px; position: fixed; top: 0; bottom: 0; overflow-y: auto; background: #f8f9fa;">
  <h4 class="text-center fw-bold mb-4">üèÅ ZRL Manager</h4>
  <nav class="nav flex-column">
    <a href="{{ url_for('admin_panel.admin_dashboard') }}" class="nav-link {% if request.endpoint == 'admin_panel.admin_dashboard' %}active{% endif %}">
      <i class="bi bi-bar-chart-fill me-2"></i> Dashboard
    </a>

    <!-- Importazioni collapsible -->
    <div class="nav-item mt-2">
      <a class="nav-link d-flex justify-content-between align-items-center collapsed" 
         data-bs-toggle="collapse" href="#importCollapseDesktop" role="button" aria-expanded="false" aria-controls="importCollapseDesktop">
        <span><i class="bi bi-arrow-repeat me-2"></i> Importazioni</span>
        <i class="bi bi-chevron-down small"></i>
      </a>
      <div class="collapse" id="importCollapseDesktop">
        <div class="nav flex-column ms-3">
          <a href="{{ url_for('admin_import_riders.import_zrl_riders') }}" class="nav-link py-1">Rider ZRL</a>
          <a href="{{ url_for('import_wtrl.import_wtrl_races') }}" class="nav-link py-1">Gare WTRL</a>
        </div>
      </div>
    </div>

    <!-- Stagioni & Round -->
    <a href="{{ url_for('admin_races.import_races') }}" class="nav-link mt-2" style="background-color:#e8f5e9; color:#2e7d32;">
      <i class="bi bi-calendar-range me-2"></i> Stagioni & Round
    </a>

    <!-- Gare collapsible -->
    <div class="nav-item mt-2">
      <a class="nav-link d-flex justify-content-between align-items-center collapsed" 
         data-bs-toggle="collapse" href="#racesCollapseDesktop" role="button" aria-expanded="false" aria-controls="racesCollapseDesktop"
         style="background-color:#fff3e0; color:#ef6c00;">
        <span><i class="bi bi-people-fill me-2"></i> Gare</span>
        <i class="bi bi-chevron-down small"></i>
      </a>
      <div class="collapse" id="racesCollapseDesktop">
        <div class="nav flex-column ms-3">
          <a href="{{ url_for('admin_races.manage_captains') }}" class="nav-link py-1">Gestione Capitani</a>
        </div>
      </div>
    </div>

    <!-- Team -->
    <a href="{{ url_for('admin_teams.manage_teams') }}" class="nav-link mt-2" style="background-color:#ede7f6; color:#512da8;">
      <i class="bi bi-people me-2"></i> Team
    </a>

    <!-- Leagues -->
    <a href="{{ url_for('admin_leagues.manage_leagues') }}" class="nav-link mt-2" style="background-color:#fffde7; color:#f9a825;">
      <i class="bi bi-trophy me-2"></i> Leagues
    </a>

    <!-- Report -->
    <a href="{{ url_for('admin_reports.index') }}" class="nav-link mt-2 {% if 'admin_reports' in request.endpoint %}active{% endif %}">
      <i class="bi bi-file-earmark-bar-graph me-2"></i> Report
    </a>

    <hr class="my-2">

    <!-- Logout -->
    <a href="{{ url_for('auth.logout') }}" class="nav-link text-white" style="background-color:#d32f2f;">
      <i class="bi bi-box-arrow-right me-2"></i> Logout
    </a>
  </nav>
</aside>

<!-- === SIDEBAR MOBILE OFFCANVAS === -->
<div class="offcanvas offcanvas-start d-lg-none" tabindex="-1" id="mobileSidebar" aria-labelledby="mobileSidebarLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title fw-bold text-primary" id="mobileSidebarLabel">üèÅ ZRL Manager</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Chiudi"></button>
  </div>
  <div class="offcanvas-body">
    <nav class="nav flex-column">
      <a href="{{ url_for('admin_panel.admin_dashboard') }}" class="nav-link {% if request.endpoint == 'admin_panel.admin_dashboard' %}active{% endif %}">
        <i class="bi bi-bar-chart-fill me-2"></i> Dashboard
      </a>

      <!-- Importazioni collapsible -->
      <div class="nav-item mt-2">
        <a class="nav-link d-flex justify-content-between align-items-center collapsed" 
           data-bs-toggle="collapse" href="#importCollapseMobile" role="button" aria-expanded="false" aria-controls="importCollapseMobile">
          <span><i class="bi bi-arrow-repeat me-2"></i> Importazioni</span>
          <i class="bi bi-chevron-down small"></i>
        </a>
        <div class="collapse" id="importCollapseMobile">
          <div class="nav flex-column ms-3">
            <a href="{{ url_for('admin_import_riders.import_zrl_riders') }}" class="nav-link py-1">Rider ZRL</a>
            <a href="{{ url_for('import_wtrl.import_wtrl_races') }}" class="nav-link py-1">Gare WTRL</a>
          </div>
        </div>
      </div>

      <!-- Stagioni & Round -->
      <a href="{{ url_for('admin_races.import_races') }}" class="nav-link mt-2" style="background-color:#e8f5e9; color:#2e7d32;">
        <i class="bi bi-calendar-range me-2"></i> Stagioni & Round
      </a>

      <!-- Gare collapsible -->
      <div class="nav-item mt-2">
        <a class="nav-link d-flex justify-content-between align-items-center collapsed" 
           data-bs-toggle="collapse" href="#racesCollapseMobile" role="button" aria-expanded="false" aria-controls="racesCollapseMobile"
           style="background-color:#fff3e0; color:#ef6c00;">
          <span><i class="bi bi-people-fill me-2"></i> Gare</span>
          <i class="bi bi-chevron-down small"></i>
        </a>
        <div class="collapse" id="racesCollapseMobile">
          <div class="nav flex-column ms-3">
            <a href="{{ url_for('admin_races.manage_captains') }}" class="nav-link py-1">Gestione Capitani</a>
          </div>
        </div>
      </div>

      <!-- Team -->
      <a href="{{ url_for('admin_teams.manage_teams') }}" class="nav-link mt-2" style="background-color:#ede7f6; color:#512da8;">
        <i class="bi bi-people me-2"></i> Team
      </a>

      <!-- Leagues -->
      <a href="{{ url_for('admin_leagues.manage_leagues') }}" class="nav-link mt-2" style="background-color:#fffde7; color:#f9a825;">
        <i class="bi bi-trophy me-2"></i> Leagues
      </a>

      <!-- Report -->
      <a href="{{ url_for('admin_reports.index') }}" class="nav-link mt-2 {% if 'admin_reports' in request.endpoint %}active{% endif %}">
        <i class="bi bi-file-earmark-bar-graph me-2"></i> Report
      </a>

      <hr class="my-2">

      <!-- Logout -->
      <a href="{{ url_for('auth.logout') }}" class="nav-link text-white" style="background-color:#d32f2f;">
        <i class="bi bi-box-arrow-right me-2"></i> Logout
      </a>
    </nav>
  </div>
</div>

<!-- === STILI CSS === -->
<style>
.nav-links a {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 10px 12px;
  font-weight: 500;
  color: #212529;
  text-decoration: none;
  border-radius: 6px;
  transition: all 0.2s ease;
}
.nav-links a:hover,
.nav-links a.active {
  color: #fff;
  background-color: #374151;
}
.sidebar.logo {
  font-size: 1.5rem;
  font-weight: 600;
  margin-bottom: 30px;
  text-align: center;
}
.main-content { transition: margin-left 0.3s ease; }
@media (min-width: 992px) {
  .main-content { margin-left: 240px; }
}
@media (max-width: 991px) {
  .main-content { margin-left: 0; }
}
</style>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

{% endif %}

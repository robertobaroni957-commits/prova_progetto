{% extends "base.html" %}

{% block title %}Coordinamento Capitani{% endblock %}
{% block page_title %}Assegna Delegato per Gara{% endblock %}

{% block content %}
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-primary text-white">ğŸ§‘â€âœˆï¸ Assegna Delegato per Gara</div>
    <div class="card-body">
      <form method="POST">
        <input type="hidden" name="action" value="assign">

        <div class="mb-3">
          <label for="team_id" class="form-label">Team:</label>
          <select name="team_id" id="team_id" class="form-select" required>
            {% for team in teams %}
              <option value="{{ team.id }}">{{ team.name }}</option>
            {% endfor %}
          </select>
        </div>

        <div class="mb-3">
          <label for="zwift_power_id" class="form-label">Rider:</label>
          <select name="zwift_power_id" id="zwift_power_id" class="form-select" required>
            {% for rider in riders %}
              <option value="{{ rider.zwift_power_id }}">{{ rider.name }}</option>
            {% endfor %}
          </select>
        </div>

        <div class="mb-3">
          <label for="race_date" class="form-label">Data gara:</label>
          <select name="race_date" id="race_date" class="form-select" required>
            {% for race in races %}
              <option value="{{ race.date }}">{{ race.date }}</option>
            {% endfor %}
          </select>
        </div>

        <button type="submit" class="btn btn-success">âœ… Assegna Delegato</button>
      </form>
    </div>
  </div>

  <div class="card shadow-sm">
    <div class="card-header bg-info text-white">ğŸ‘€ Delegati Assegnati</div>
    <div class="card-body">
      <table class="table table-bordered align-middle">
        <thead class="table-light">
          <tr>
            <th>Team</th>
            <th>Rider</th>
            <th>Data Gara</th>
            <th>Azioni</th>
          </tr>
        </thead>
        <tbody>
          {% for d in assigned_delegates %}
          <tr>
            <td>{{ d.team_name }}</td>
            <td>{{ d.rider_name }}</td>
            <td>{{ d.race_date }}</td>
            <td>
              <form method="POST" class="d-inline">
                <input type="hidden" name="action" value="remove">
                <input type="hidden" name="team_id" value="{{ d.team_id }}">
                <input type="hidden" name="race_date" value="{{ d.race_date }}">
                <button type="submit" class="btn btn-sm btn-outline-danger" aria-label="Rimuovi delegato">ğŸ—‘ï¸ Rimuovi</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
{% endblock %}
{% extends "base.html" %}
{% block title %}Report Amministrativi{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2 class="mb-3"><i class="bi bi-graph-up"></i> Report Amministrativi</h2>

  <!-- Selezione tipo di report -->
  <form method="get" class="mb-3">
    <label for="type">Scegli il tipo di report:</label>
    <select name="type" id="type" class="form-select w-auto d-inline-block" onchange="this.form.submit()">
      <option value="riders" {% if report_type=='riders' %}selected{% endif %}>Riders</option>
      <option value="teams" {% if report_type=='teams' %}selected{% endif %}>Teams</option>
      <option value="races" {% if report_type=='races' %}selected{% endif %}>Races</option>
    </select>
  </form>

  <!-- Pulsanti esportazione -->
  <div class="mb-3">
    <a href="{{ url_for('admin_reports.export_excel', type=report_type) }}" class="btn btn-success btn-sm">
      ðŸ“Š Esporta Excel
    </a>
    <a href="{{ url_for('admin_reports.export_pdf', type=report_type) }}" class="btn btn-danger btn-sm">
      ðŸ“„ Esporta PDF
    </a>
  </div>

  <!-- Totale -->
  <div class="alert alert-info">
    Totale record trovati: <strong>{{ total }}</strong>
  </div>

  <!-- Tabella -->
  {% if data %}
  <div style="max-height: 600px; overflow-y: auto;">
    <table class="table table-striped table-bordered table-sm">
      <thead class="table-light sticky-top">
        <tr>
          {% for col in columns %}
          <th>{{ col }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for row in data %}
        <tr>
          {% for col in columns %}
          <td>{{ row[col] }}</td>
          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <p class="text-muted">Nessun dato disponibile.</p>
  {% endif %}
</div>
{% endblock %}

{% extends 'base.html' %}
{% block title %}Gestione Stagioni e Round{% endblock %}
{% block content %}

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<h2 class="mb-4">ğŸ“… Gestione Stagioni e Round</h2>

<div class="row">
  <div class="col-md-6">
    <h4>â• Aggiungi manualmente</h4>
    <form method="POST" action="{{ url_for('admin_imports.import_rounds') }}">
      <div class="mb-3">
        <label for="season_name" class="form-label">Nome stagione</label>
        <input type="text" id="season_name" name="season_name" class="form-control" required>
      </div>
      <div class="mb-3">
        <label for="season_start" class="form-label">Data inizio stagione</label>
        <input type="date" id="season_start" name="season_start" class="form-control" required>
      </div>
      <div class="mb-3">
        <label for="season_end" class="form-label">Data fine stagione</label>
        <input type="date" id="season_end" name="season_end" class="form-control" required>
      </div>
      <hr>
      <div class="mb-3">
        <label for="round_number" class="form-label">Numero round</label>
        <input type="number" id="round_number" name="round_number" class="form-control" required>
      </div>
      <div class="mb-3">
        <label for="round_name" class="form-label">Nome round</label>
        <input type="text" id="round_name" name="round_name" class="form-control">
      </div>
      <div class="mb-3">
        <label for="round_start" class="form-label">Data inizio round</label>
        <input type="date" id="round_start" name="round_start" class="form-control">
      </div>
      <div class="mb-3">
        <label for="round_end" class="form-label">Data fine round</label>
        <input type="date" id="round_end" name="round_end" class="form-control">
      </div>
      <button type="submit" class="btn btn-success mt-2">âœ… Inserisci</button>
    </form>
  </div>

  <div class="col-md-6">
    <h4>ğŸ“¦ Importa da WTRL</h4>
    <form method="POST" action="{{ url_for('admin_imports.import_rounds') }}">
      <input type="hidden" name="season_name" value="ZRL 2025/26">
      <input type="hidden" name="start_year" value="2025">
      <input type="hidden" name="end_year" value="2026">
      <button type="submit" class="btn btn-primary mt-4">ğŸ“¦ Importa stagione completa</button>
    </form>

    <a href="{{ url_for('admin_races.import_races') }}" class="btn btn-outline-info mt-3">
      ğŸ“‹ Visualizza riepilogo importazione
    </a>
  </div>
</div>

<hr class="my-5">

<h4 class="mb-3">ğŸ“š Stagioni esistenti</h4>
{% if seasons %}
  <ul class="list-group">
    {% for season in seasons %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <div>
          <strong>{{ season.name }}</strong><br>
          {{ season.start_year or season.start }} â†’ {{ season.end_year or season.end }}
        </div>
        <a href="{{ url_for('races.view_rounds', season_id=season.id) }}" class="btn btn-sm btn-outline-secondary">
          ğŸ” Visualizza round
        </a>
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p class="text-muted">Nessuna stagione registrata.</p>
{% endif %}

{% endblock %}